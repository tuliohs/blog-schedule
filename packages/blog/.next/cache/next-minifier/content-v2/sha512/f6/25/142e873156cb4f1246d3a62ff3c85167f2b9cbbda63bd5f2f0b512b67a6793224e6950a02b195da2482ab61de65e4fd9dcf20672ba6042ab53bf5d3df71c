{"code":"(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[24],{W9RZ:function(e,t,n){\"use strict\";n.r(t);var r=n(\"nKUr\"),a=n(\"vJKn\"),c=n.n(a),o=n(\"rg98\"),s=(n(\"q1tI\"),n(\"Z3vd\")),i=(n(\"ChW8\"),\"https://js.stripe.com/v3\"),u=/^https:\\/\\/js\\.stripe\\.com\\/v3\\/?(\\?.*)?$/,d=\"loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used\",p=null,l=function(e){return null!==p?p:p=new Promise((function(t,n){if(\"undefined\"!==typeof window)if(window.Stripe&&e&&console.warn(d),window.Stripe)t(window.Stripe);else try{var r=function(){for(var e=document.querySelectorAll('script[src^=\"'.concat(i,'\"]')),t=0;t<e.length;t++){var n=e[t];if(u.test(n.src))return n}return null}();r&&e?console.warn(d):r||(r=function(e){var t=e&&!e.advancedFraudSignals?\"?advancedFraudSignals=false\":\"\",n=document.createElement(\"script\");n.src=\"\".concat(i).concat(t);var r=document.head||document.body;if(!r)throw new Error(\"Expected document.body not to be null. Stripe.js requires a <body> element.\");return r.appendChild(n),n}(e)),r.addEventListener(\"load\",(function(){window.Stripe?t(window.Stripe):n(new Error(\"Stripe.js not available\"))})),r.addEventListener(\"error\",(function(){n(new Error(\"Failed to load Stripe.js\"))}))}catch(a){return void n(a)}else t(null)}))},f=function(e,t,n){if(null===e)return null;var r=e.apply(void 0,t);return function(e,t){e&&e._registerWrapper&&e._registerWrapper({name:\"stripe-js\",version:\"1.11.0\",startTime:t})}(r,n),r},w=Promise.resolve().then((function(){return l(null)})),v=!1;w.catch((function(e){v||console.warn(e)}));var h=n(\"6y3N\"),b=n(\"uDfI\"),m=n(\"20a2\"),y=n(\"vcXL\"),k=n.n(y);t.default=Object(b.connect)((function(e){return{siteInfo:e.siteinfo,auth:e.auth,address:e.address}}))((function(e){var t=e.course,n=e.siteInfo,a=e.auth,i=e.address,u=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];v=!0;var r=Date.now();return w.then((function(e){return f(e,t,r)}))}(n.stripePublishableKey),d=Object(m.useRouter)(),p=function(){var e=Object(o.a)(c.a.mark((function e(){var n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l({courseId:t.id,backend:i.backend,token:a.token,frontend:i.frontend,router:d});case 2:if(401!==(n=e.sent).status){e.next=6;break}return d.push(\"/login?redirect=\".concat(d.asPath)),e.abrupt(\"return\");case 6:return e.prev=6,e.next=9,n.json();case 9:return n=e.sent,e.t0=b,e.next=13,u;case 13:return e.t1=e.sent,e.t2=n.paymentTracker,e.t3={stripe:e.t1,sessionId:e.t2},e.next=18,(0,e.t0)(e.t3);case 18:e.next=22;break;case 20:e.prev=20,e.t4=e.catch(6);case 22:case\"end\":return e.stop()}}),e,null,[[6,20]])})));return function(){return e.apply(this,arguments)}}(),l=function(){var e=Object(o.a)(c.a.mark((function e(t){var n,r,a,o,s,i,u;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.courseId,r=t.backend,a=t.token,o=t.router,s=t.frontend,(i=new window.FormData).append(\"courseid\",n),i.append(\"metadata\",JSON.stringify({cancelUrl:\"\".concat(s).concat(o.asPath),successUrl:\"\".concat(s,\"/purchase\"),sourceUrl:o.asPath})),e.next=6,k()(\"\".concat(r,\"/payment/initiate\"),{method:\"POST\",headers:{Authorization:\"Bearer \".concat(a)},body:i});case 6:return u=e.sent,e.abrupt(\"return\",u);case 8:case\"end\":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),b=function(){var e=Object(o.a)(c.a.mark((function e(t){var n,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.stripe,r=t.sessionId,e.next=3,n.redirectToCheckout({sessionId:r});case 3:e.sent.error;case 5:case\"end\":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(r.jsx)(s.a,{onClick:p,variant:\"contained\",color:\"primary\",children:h.c})}))}}]);","map":{"version":3,"sources":["static/chunks/24.0e4a3065c568bdf79e84.js"],"names":["window","push","W9RZ","module","__webpack_exports__","__webpack_require__","r","jsx_runtime","regenerator","regenerator_default","n","asyncToGenerator","Button","V3_URL","V3_URL_REGEX","EXISTING_SCRIPT_MESSAGE","stripe_esm_stripePromise","loadScript","params","Promise","resolve","reject","Stripe","console","warn","script","scripts","document","querySelectorAll","concat","i","length","test","src","findScript","queryString","advancedFraudSignals","createElement","headOrBody","head","body","Error","appendChild","injectScript","addEventListener","error","initStripe","maybeStripe","args","startTime","stripe","apply","undefined","_registerWrapper","name","version","registerWrapper","stripePromise$1","then","loadCalled","err","strings","es","next_router","fetch","fetch_default","Object","state","siteInfo","siteinfo","auth","address","props","course","stripePromise","_len","arguments","Array","_key","Date","now","loadStripe","stripePublishableKey","router","handleClick","_ref","a","mark","_callee","initiatePaymentResponse","wrap","_context","prev","next","makePaymentRequest","courseId","id","backend","token","frontend","sent","status","asPath","abrupt","json","t0","redirectToStripeCheckout","t1","t2","paymentTracker","t3","sessionId","t4","stop","this","_ref3","_callee2","_ref2","formData","res","_context2","FormData","append","JSON","stringify","cancelUrl","successUrl","sourceUrl","method","headers","Authorization","_x","_ref5","_callee3","_ref4","_context3","redirectToCheckout","_x2","onClick","variant","color","children"],"mappings":"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"},"name":"static/chunks/24.0e4a3065c568bdf79e84.js","input":"(window[\"webpackJsonp_N_E\"] = window[\"webpackJsonp_N_E\"] || []).push([[24],{\n\n/***/ \"W9RZ\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n// ESM COMPAT FLAG\n__webpack_require__.r(__webpack_exports__);\n\n// EXTERNAL MODULE: ./node_modules/react/jsx-runtime.js\nvar jsx_runtime = __webpack_require__(\"nKUr\");\n\n// EXTERNAL MODULE: ./node_modules/next/node_modules/@babel/runtime/regenerator/index.js\nvar regenerator = __webpack_require__(\"vJKn\");\nvar regenerator_default = /*#__PURE__*/__webpack_require__.n(regenerator);\n\n// EXTERNAL MODULE: ./node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\nvar asyncToGenerator = __webpack_require__(\"rg98\");\n\n// EXTERNAL MODULE: ./node_modules/react/index.js\nvar react = __webpack_require__(\"q1tI\");\n\n// EXTERNAL MODULE: ./node_modules/@material-ui/core/esm/Button/Button.js\nvar Button = __webpack_require__(\"Z3vd\");\n\n// EXTERNAL MODULE: ./types.js\nvar types = __webpack_require__(\"ChW8\");\n\n// CONCATENATED MODULE: C:/Users/MGS/Sistemas/temp/courselit/node_modules/@stripe/stripe-js/dist/stripe.esm.js\nvar V3_URL = 'https://js.stripe.com/v3';\nvar V3_URL_REGEX = /^https:\\/\\/js\\.stripe\\.com\\/v3\\/?(\\?.*)?$/;\nvar EXISTING_SCRIPT_MESSAGE = 'loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used';\nvar findScript = function findScript() {\n  var scripts = document.querySelectorAll(\"script[src^=\\\"\".concat(V3_URL, \"\\\"]\"));\n\n  for (var i = 0; i < scripts.length; i++) {\n    var script = scripts[i];\n\n    if (!V3_URL_REGEX.test(script.src)) {\n      continue;\n    }\n\n    return script;\n  }\n\n  return null;\n};\n\nvar injectScript = function injectScript(params) {\n  var queryString = params && !params.advancedFraudSignals ? '?advancedFraudSignals=false' : '';\n  var script = document.createElement('script');\n  script.src = \"\".concat(V3_URL).concat(queryString);\n  var headOrBody = document.head || document.body;\n\n  if (!headOrBody) {\n    throw new Error('Expected document.body not to be null. Stripe.js requires a <body> element.');\n  }\n\n  headOrBody.appendChild(script);\n  return script;\n};\n\nvar registerWrapper = function registerWrapper(stripe, startTime) {\n  if (!stripe || !stripe._registerWrapper) {\n    return;\n  }\n\n  stripe._registerWrapper({\n    name: 'stripe-js',\n    version: \"1.11.0\",\n    startTime: startTime\n  });\n};\n\nvar stripe_esm_stripePromise = null;\nvar loadScript = function loadScript(params) {\n  // Ensure that we only attempt to load Stripe.js at most once\n  if (stripe_esm_stripePromise !== null) {\n    return stripe_esm_stripePromise;\n  }\n\n  stripe_esm_stripePromise = new Promise(function (resolve, reject) {\n    if (typeof window === 'undefined') {\n      // Resolve to null when imported server side. This makes the module\n      // safe to import in an isomorphic code base.\n      resolve(null);\n      return;\n    }\n\n    if (window.Stripe && params) {\n      console.warn(EXISTING_SCRIPT_MESSAGE);\n    }\n\n    if (window.Stripe) {\n      resolve(window.Stripe);\n      return;\n    }\n\n    try {\n      var script = findScript();\n\n      if (script && params) {\n        console.warn(EXISTING_SCRIPT_MESSAGE);\n      } else if (!script) {\n        script = injectScript(params);\n      }\n\n      script.addEventListener('load', function () {\n        if (window.Stripe) {\n          resolve(window.Stripe);\n        } else {\n          reject(new Error('Stripe.js not available'));\n        }\n      });\n      script.addEventListener('error', function () {\n        reject(new Error('Failed to load Stripe.js'));\n      });\n    } catch (error) {\n      reject(error);\n      return;\n    }\n  });\n  return stripe_esm_stripePromise;\n};\nvar initStripe = function initStripe(maybeStripe, args, startTime) {\n  if (maybeStripe === null) {\n    return null;\n  }\n\n  var stripe = maybeStripe.apply(undefined, args);\n  registerWrapper(stripe, startTime);\n  return stripe;\n};\n\n// own script injection.\n\nvar stripePromise$1 = Promise.resolve().then(function () {\n  return loadScript(null);\n});\nvar loadCalled = false;\nstripePromise$1[\"catch\"](function (err) {\n  if (!loadCalled) {\n    console.warn(err);\n  }\n});\nvar loadStripe = function loadStripe() {\n  for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n    args[_key] = arguments[_key];\n  }\n\n  loadCalled = true;\n  var startTime = Date.now();\n  return stripePromise$1.then(function (maybeStripe) {\n    return initStripe(maybeStripe, args, startTime);\n  });\n};\n\n\n\n// EXTERNAL MODULE: ./config/strings.js\nvar strings = __webpack_require__(\"6y3N\");\n\n// EXTERNAL MODULE: C:/Users/MGS/Sistemas/temp/courselit/node_modules/react-redux/es/index.js + 25 modules\nvar es = __webpack_require__(\"uDfI\");\n\n// EXTERNAL MODULE: ./node_modules/next/router.js\nvar next_router = __webpack_require__(\"20a2\");\n\n// EXTERNAL MODULE: ./node_modules/next/dist/build/polyfills/fetch/index.js\nvar fetch = __webpack_require__(\"vcXL\");\nvar fetch_default = /*#__PURE__*/__webpack_require__.n(fetch);\n\n// CONCATENATED MODULE: ./components/CheckoutExternal/Stripe.js\n\n\n\n\n\n\n\n\n\n\n\n\nvar Stripe_Stripe = function Stripe(props) {\n  var course = props.course,\n      siteInfo = props.siteInfo,\n      auth = props.auth,\n      address = props.address;\n  var stripePromise = loadStripe(siteInfo.stripePublishableKey);\n  var router = Object(next_router[\"useRouter\"])();\n\n  var handleClick = /*#__PURE__*/function () {\n    var _ref = Object(asyncToGenerator[\"a\" /* default */])( /*#__PURE__*/regenerator_default.a.mark(function _callee() {\n      var initiatePaymentResponse;\n      return regenerator_default.a.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return makePaymentRequest({\n                courseId: course.id,\n                backend: address.backend,\n                token: auth.token,\n                frontend: address.frontend,\n                router: router\n              });\n\n            case 2:\n              initiatePaymentResponse = _context.sent;\n\n              if (!(initiatePaymentResponse.status === 401)) {\n                _context.next = 6;\n                break;\n              }\n\n              router.push(\"/login?redirect=\".concat(router.asPath));\n              return _context.abrupt(\"return\");\n\n            case 6:\n              _context.prev = 6;\n              _context.next = 9;\n              return initiatePaymentResponse.json();\n\n            case 9:\n              initiatePaymentResponse = _context.sent;\n              _context.t0 = redirectToStripeCheckout;\n              _context.next = 13;\n              return stripePromise;\n\n            case 13:\n              _context.t1 = _context.sent;\n              _context.t2 = initiatePaymentResponse.paymentTracker;\n              _context.t3 = {\n                stripe: _context.t1,\n                sessionId: _context.t2\n              };\n              _context.next = 18;\n              return (0, _context.t0)(_context.t3);\n\n            case 18:\n              _context.next = 22;\n              break;\n\n            case 20:\n              _context.prev = 20;\n              _context.t4 = _context[\"catch\"](6);\n\n            case 22:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[6, 20]]);\n    }));\n\n    return function handleClick() {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  var makePaymentRequest = /*#__PURE__*/function () {\n    var _ref3 = Object(asyncToGenerator[\"a\" /* default */])( /*#__PURE__*/regenerator_default.a.mark(function _callee2(_ref2) {\n      var courseId, backend, token, router, frontend, formData, res;\n      return regenerator_default.a.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              courseId = _ref2.courseId, backend = _ref2.backend, token = _ref2.token, router = _ref2.router, frontend = _ref2.frontend;\n              formData = new window.FormData();\n              formData.append(\"courseid\", courseId);\n              formData.append(\"metadata\", JSON.stringify({\n                cancelUrl: \"\".concat(frontend).concat(router.asPath),\n                successUrl: \"\".concat(frontend, \"/purchase\"),\n                sourceUrl: router.asPath\n              }));\n              _context2.next = 6;\n              return fetch_default()(\"\".concat(backend, \"/payment/initiate\"), {\n                method: \"POST\",\n                headers: {\n                  Authorization: \"Bearer \".concat(token)\n                },\n                body: formData\n              });\n\n            case 6:\n              res = _context2.sent;\n              return _context2.abrupt(\"return\", res);\n\n            case 8:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function makePaymentRequest(_x) {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  var redirectToStripeCheckout = /*#__PURE__*/function () {\n    var _ref5 = Object(asyncToGenerator[\"a\" /* default */])( /*#__PURE__*/regenerator_default.a.mark(function _callee3(_ref4) {\n      var stripe, sessionId, result;\n      return regenerator_default.a.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              stripe = _ref4.stripe, sessionId = _ref4.sessionId;\n              _context3.next = 3;\n              return stripe.redirectToCheckout({\n                sessionId: sessionId\n              });\n\n            case 3:\n              result = _context3.sent;\n\n              if (result.error) {// console.log(result.error);\n              }\n\n            case 5:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }));\n\n    return function redirectToStripeCheckout(_x2) {\n      return _ref5.apply(this, arguments);\n    };\n  }();\n\n  return /*#__PURE__*/Object(jsx_runtime[\"jsx\"])(Button[\"a\" /* default */], {\n    onClick: handleClick,\n    variant: \"contained\",\n    color: \"primary\",\n    children: strings[\"c\" /* ENROLL_BUTTON_TEXT */]\n  });\n};\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    siteInfo: state.siteinfo,\n    auth: state.auth,\n    address: state.address\n  };\n};\n\n/* harmony default export */ var CheckoutExternal_Stripe = __webpack_exports__[\"default\"] = (Object(es[\"connect\"])(mapStateToProps)(Stripe_Stripe));\n\n/***/ })\n\n}]);","inputSourceMap":{"version":3,"sources":["C:\\Users\\MGS\\Sistemas\\temp\\courselit\\node_modules\\@stripe\\stripe-js\\dist\\stripe.esm.js","C:\\Users\\MGS\\Sistemas\\temp\\courselit\\packages\\blog\\node_modules\\next\\dist\\build\\webpack\\loaders\\next-babel-loader.js??ref--4!C:\\Users\\MGS\\Sistemas\\temp\\courselit\\packages\\blog\\components\\CheckoutExternal\\Stripe.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA,uIAAuI;AACvI;AACA;;AAEA,iBAAiB,oBAAoB;AACrC;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA,IAAI,wBAAa;AACjB;AACA;AACA,MAAM,wBAAa;AACnB,WAAW,wBAAa;AACxB;;AAEA,EAAE,wBAAa;AACf;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,OAAO;AACP;AACA;;AAEA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,OAAO;AACP;AACA;AACA,OAAO;AACP,KAAK;AACL;AACA;AACA;AACA,GAAG;AACH,SAAS,wBAAa;AACtB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA,qEAAqE,aAAa;AAClF;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEsB;;;;;;;;;;;;;;;;AChI0B;AAC+F;AACe;AACpI;AACiB;AACwC;AACpC;AACW;AACpB;AACE;AACD;;AAEvC,IAAI,aAAM;AACV;AACA;AACA;AACA;AACA,sBAAsB,UAAU;AAChC,eAAe,gCAAS;;AAExB;AACA,eAAe,2CAAiB,eAAe,qBAAmB;AAClE;AACA,aAAa,qBAAmB;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe;;AAEf;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP,KAAK;;AAEL;AACA;AACA;AACA,GAAG;;AAEH;AACA,gBAAgB,2CAAiB,eAAe,qBAAmB;AACnE;AACA,aAAa,qBAAmB;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe;AACf;AACA,qBAAqB,eAAK;AAC1B;AACA;AACA;AACA,iBAAiB;AACjB;AACA,eAAe;;AAEf;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP,KAAK;;AAEL;AACA;AACA;AACA,GAAG;;AAEH;AACA,gBAAgB,2CAAiB,eAAe,qBAAmB;AACnE;AACA,aAAa,qBAAmB;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe;;AAEf;AACA;;AAEA,iCAAiC;AACjC;;AAEA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP,KAAK;;AAEL;AACA;AACA;AACA,GAAG;;AAEH,sBAAsB,0BAAI,CAAC,yBAAM;AACjC;AACA;AACA;AACA,cAAc,qCAAkB;AAChC,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEe,kHAAO,kBAAkB,aAAM,CAAC,E","file":"x","sourcesContent":["var V3_URL = 'https://js.stripe.com/v3';\nvar V3_URL_REGEX = /^https:\\/\\/js\\.stripe\\.com\\/v3\\/?(\\?.*)?$/;\nvar EXISTING_SCRIPT_MESSAGE = 'loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used';\nvar findScript = function findScript() {\n  var scripts = document.querySelectorAll(\"script[src^=\\\"\".concat(V3_URL, \"\\\"]\"));\n\n  for (var i = 0; i < scripts.length; i++) {\n    var script = scripts[i];\n\n    if (!V3_URL_REGEX.test(script.src)) {\n      continue;\n    }\n\n    return script;\n  }\n\n  return null;\n};\n\nvar injectScript = function injectScript(params) {\n  var queryString = params && !params.advancedFraudSignals ? '?advancedFraudSignals=false' : '';\n  var script = document.createElement('script');\n  script.src = \"\".concat(V3_URL).concat(queryString);\n  var headOrBody = document.head || document.body;\n\n  if (!headOrBody) {\n    throw new Error('Expected document.body not to be null. Stripe.js requires a <body> element.');\n  }\n\n  headOrBody.appendChild(script);\n  return script;\n};\n\nvar registerWrapper = function registerWrapper(stripe, startTime) {\n  if (!stripe || !stripe._registerWrapper) {\n    return;\n  }\n\n  stripe._registerWrapper({\n    name: 'stripe-js',\n    version: \"1.11.0\",\n    startTime: startTime\n  });\n};\n\nvar stripePromise = null;\nvar loadScript = function loadScript(params) {\n  // Ensure that we only attempt to load Stripe.js at most once\n  if (stripePromise !== null) {\n    return stripePromise;\n  }\n\n  stripePromise = new Promise(function (resolve, reject) {\n    if (typeof window === 'undefined') {\n      // Resolve to null when imported server side. This makes the module\n      // safe to import in an isomorphic code base.\n      resolve(null);\n      return;\n    }\n\n    if (window.Stripe && params) {\n      console.warn(EXISTING_SCRIPT_MESSAGE);\n    }\n\n    if (window.Stripe) {\n      resolve(window.Stripe);\n      return;\n    }\n\n    try {\n      var script = findScript();\n\n      if (script && params) {\n        console.warn(EXISTING_SCRIPT_MESSAGE);\n      } else if (!script) {\n        script = injectScript(params);\n      }\n\n      script.addEventListener('load', function () {\n        if (window.Stripe) {\n          resolve(window.Stripe);\n        } else {\n          reject(new Error('Stripe.js not available'));\n        }\n      });\n      script.addEventListener('error', function () {\n        reject(new Error('Failed to load Stripe.js'));\n      });\n    } catch (error) {\n      reject(error);\n      return;\n    }\n  });\n  return stripePromise;\n};\nvar initStripe = function initStripe(maybeStripe, args, startTime) {\n  if (maybeStripe === null) {\n    return null;\n  }\n\n  var stripe = maybeStripe.apply(undefined, args);\n  registerWrapper(stripe, startTime);\n  return stripe;\n};\n\n// own script injection.\n\nvar stripePromise$1 = Promise.resolve().then(function () {\n  return loadScript(null);\n});\nvar loadCalled = false;\nstripePromise$1[\"catch\"](function (err) {\n  if (!loadCalled) {\n    console.warn(err);\n  }\n});\nvar loadStripe = function loadStripe() {\n  for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n    args[_key] = arguments[_key];\n  }\n\n  loadCalled = true;\n  var startTime = Date.now();\n  return stripePromise$1.then(function (maybeStripe) {\n    return initStripe(maybeStripe, args, startTime);\n  });\n};\n\nexport { loadStripe };\n","import { jsx as _jsx } from \"react/jsx-runtime\";\nimport _regeneratorRuntime from \"C:/Users/MGS/Sistemas/temp/courselit/packages/blog/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"C:/Users/MGS/Sistemas/temp/courselit/packages/blog/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport React from \"react\";\nimport { Button } from \"@material-ui/core\";\nimport { addressProps, authProps, publicCourse, siteInfoProps } from \"../../types\";\nimport { loadStripe } from \"@stripe/stripe-js\";\nimport { ENROLL_BUTTON_TEXT } from \"../../config/strings\";\nimport { connect } from \"react-redux\";\nimport { useRouter } from \"next/router\";\nimport fetch from \"isomorphic-unfetch\";\n\nvar Stripe = function Stripe(props) {\n  var course = props.course,\n      siteInfo = props.siteInfo,\n      auth = props.auth,\n      address = props.address;\n  var stripePromise = loadStripe(siteInfo.stripePublishableKey);\n  var router = useRouter();\n\n  var handleClick = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var initiatePaymentResponse;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return makePaymentRequest({\n                courseId: course.id,\n                backend: address.backend,\n                token: auth.token,\n                frontend: address.frontend,\n                router: router\n              });\n\n            case 2:\n              initiatePaymentResponse = _context.sent;\n\n              if (!(initiatePaymentResponse.status === 401)) {\n                _context.next = 6;\n                break;\n              }\n\n              router.push(\"/login?redirect=\".concat(router.asPath));\n              return _context.abrupt(\"return\");\n\n            case 6:\n              _context.prev = 6;\n              _context.next = 9;\n              return initiatePaymentResponse.json();\n\n            case 9:\n              initiatePaymentResponse = _context.sent;\n              _context.t0 = redirectToStripeCheckout;\n              _context.next = 13;\n              return stripePromise;\n\n            case 13:\n              _context.t1 = _context.sent;\n              _context.t2 = initiatePaymentResponse.paymentTracker;\n              _context.t3 = {\n                stripe: _context.t1,\n                sessionId: _context.t2\n              };\n              _context.next = 18;\n              return (0, _context.t0)(_context.t3);\n\n            case 18:\n              _context.next = 22;\n              break;\n\n            case 20:\n              _context.prev = 20;\n              _context.t4 = _context[\"catch\"](6);\n\n            case 22:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[6, 20]]);\n    }));\n\n    return function handleClick() {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  var makePaymentRequest = /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(_ref2) {\n      var courseId, backend, token, router, frontend, formData, res;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              courseId = _ref2.courseId, backend = _ref2.backend, token = _ref2.token, router = _ref2.router, frontend = _ref2.frontend;\n              formData = new window.FormData();\n              formData.append(\"courseid\", courseId);\n              formData.append(\"metadata\", JSON.stringify({\n                cancelUrl: \"\".concat(frontend).concat(router.asPath),\n                successUrl: \"\".concat(frontend, \"/purchase\"),\n                sourceUrl: router.asPath\n              }));\n              _context2.next = 6;\n              return fetch(\"\".concat(backend, \"/payment/initiate\"), {\n                method: \"POST\",\n                headers: {\n                  Authorization: \"Bearer \".concat(token)\n                },\n                body: formData\n              });\n\n            case 6:\n              res = _context2.sent;\n              return _context2.abrupt(\"return\", res);\n\n            case 8:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function makePaymentRequest(_x) {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  var redirectToStripeCheckout = /*#__PURE__*/function () {\n    var _ref5 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(_ref4) {\n      var stripe, sessionId, result;\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              stripe = _ref4.stripe, sessionId = _ref4.sessionId;\n              _context3.next = 3;\n              return stripe.redirectToCheckout({\n                sessionId: sessionId\n              });\n\n            case 3:\n              result = _context3.sent;\n\n              if (result.error) {// console.log(result.error);\n              }\n\n            case 5:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }));\n\n    return function redirectToStripeCheckout(_x2) {\n      return _ref5.apply(this, arguments);\n    };\n  }();\n\n  return /*#__PURE__*/_jsx(Button, {\n    onClick: handleClick,\n    variant: \"contained\",\n    color: \"primary\",\n    children: ENROLL_BUTTON_TEXT\n  });\n};\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    siteInfo: state.siteinfo,\n    auth: state.auth,\n    address: state.address\n  };\n};\n\nexport default connect(mapStateToProps)(Stripe);"]}}